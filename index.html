<html>
<head>
        <meta charset="utf-8" />
		
		
        <title>CATNAT</title>
		 
		  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
		  

		  <!-- CSS  -->
		  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		  <link href="materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
		  
		  <script src="https://d3js.org/d3.v4.min.js"></script>
		  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	</head>
<body>
<div>
<div class="navbar-fixed">
<nav class="orange" role="navigation">
	<a href="#" class="brand-logo">CATNAT -Find more about natural disasters</a>
    
  </nav>	  
  </div>
   <div class="row">
   			<div class="col s2 orange lighten-2">
   				<form action="#">
   				<p>
				      <label>
				        <input class="with-gap" name="group1" type="radio" checked />
				        <span class="white-text">World Map</span>
				      </label>
				    </p>
				    <p>
				      <label>
				        <input class="with-gap" name="group1" type="radio" />
				        <span class="white-text">Tree Map</span>
				      </label>
				    </p>
				    <p>
				      <label>
				        <input class="with-gap " name="group1" type="radio"  />
				        <span class="white-text">Link Graph</span>
				      </label>
				    </p>
			    <p>
			      <label>
			        <input type="checkbox" class="filled-in" onclick="zoom(-60,30,350,'North America')"/>
			        <span class="white-text">North America</span>
			      </label>
			    </p>
			    <p>
			      <label>
			        <input type="checkbox" class="filled-in" onclick="zoom(30,48,670, 'Europe')" />
			        <span class="white-text">Europe</span>
			      </label>
			    </p>
			    <p>
			      <label>
			        <input type="checkbox" class="filled-in" onclick="zoom(30,-9,300,'Africa')" />
			        <span class="white-text">Africa</span>
			      </label>
			    </p>
			    
			  </form>
   			</div>
   			<div class="col s8" >
   				<div id="svgcontainer"></div>
   				<div class="row">
   					<div class="col s1 offset-s2"> <img src="drought.png"  onclick="change('Drought')" width="100%"/></div>
   					<div class="col s1"> <img src="earthquake.png" onclick="change('Earthquake')" width="100%"/></div>
   					<div class="col s1"> <img src="extremetemperature.png" onclick="change('Extreme Temperature (dry)')" width="100%" /></div>
   					<div class="col s1"> <img src="fog.png" width="100%" onclick="change('Fog')" style="border:2px solid black;border-radius:50%"/></div>
   					<div class="col s1"> <img src="impact.png" onclick="change('Impact')" width="100%"/></div>
   					<div class="col s1"> <img src="storm.png" onclick="change('Storm')" width="100%"/></div>
   					<div class="col s1"> <img src="wildfire.png" onclick="change('Wildfire')" width="100%"/></div>
   					<div class="col s1"> <img src="volcano.png" onclick="change('Volcanic activity')" width="100%"/></div>
   				</div>
   			</div>
   			<div class="col s2" id="details">
   				
   			</div>
   		
   </div>

  





</div>



<footer class="page-footer orange" >
    
    <div class="footer-copyright">
      <div class="container">
      Créé par Guillaume Le Gall, Jean-Thomas Beaudoin et Donatien Vaast
      </div>
    </div>
  </footer>

<script>
		
  		var height = 430;
		var svg = d3.select( "#svgcontainer" )
  		.append( "svg" )
		  .attr( "height", height );

    var projection = d3.geoNaturalEarth1();
    projection.center([60.454071, -10]).scale(140)

    var path = d3.geoPath() // d3.geo.path avec d3 version 3
                 .projection(projection);
    

		// Load external data and boot
		
d3.json("https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson", function(data){

  
  
    // Draw the map
    svg.append("g")
        .selectAll("path")
        .data(data.features)
        .enter().append("path")
            .attr("fill", "#69b3a2")
            .attr("d", path)
            .style("stroke", "#fff")
            .style("opacity", 0.6)
})
    d3.csv("https://raw.githubusercontent.com/glegall7/datavizCATNAT/master/test6.csv", function(data){
      //console.log(data)
      d3.csv("https://raw.githubusercontent.com/glegall7/datavizCATNAT/master/couleur.csv", function(couleur){
      //console.log(couleur)
      
      svg.append("g").selectAll("circle")
		.data(data).enter()
		.append("circle")
		.attr("cx", function (d) {return projection([d.newlongitude,d.newlatitude])[0]; })
		.attr("cy", function (d) { return projection([d.newlongitude,d.newlatitude])[1]; })
		.attr("r", "1px")
		.attr("fill", function (d) {
			var color=''
			for (var item in couleur) {
				if(couleur[item]['Cat']==d.Disaster_type){
				color=couleur[item]['Color']
					}
				}
			
			return color})
		.style("opacity", 1)
		.on("mouseover", function(d,i){ 
    			d3.selectAll("circle")
          .style("opacity", .3)
          d3.select(this).style("opacity",1)
          elm=document.getElementById("details")
          elm.innerHTML='<li>'+d.Country+'</li>'
    })
    .on("mouseout", function(d) {d3.selectAll("circle")
          .style("opacity", 1)
          elm=document.getElementById("details")
          elm.innerHTML=''   ;   
    })
    
      })
    })

    function change(elm){
			var circles =d3.selectAll("circle")
							.filter(function(d) { return d.Disaster_type == elm })
							.style("opacity", 1)
							.attr("r", 3)
			d3.selectAll("circle")
							.filter(function(d) { return d.Disaster_type != elm })
							.style("opacity", .3)
							.attr("r", 2)
		}
	function zoom(a,b,c,continent){
		
		path = path.projection(projection.center([a,b]).scale(c));
		d3.selectAll("path")
		.transition()
	      	.duration(0)
	      	.attr("d", path);
		svg.selectAll("circle")
		.attr("cx", function (d) {return projection([d.newlongitude,d.newlatitude])[0]; })
		.attr("cy", function (d) { return projection([d.newlongitude,d.newlatitude])[1]; })
		.attr("r", 2)
		
		d3.selectAll("circle")
							.filter(function(d) { return d.continent == continent })
							.style("opacity", 0.7)
							.attr("r", 4)
			d3.selectAll("circle")
							.filter(function(d) { return d.continent != continent })
							.style("opacity", .1)
							.attr("r", 2)
	}
  </script>
  <style>
  	svg { display: block;
  	width:100%}
  	g { 
  	width:100%}
  	.col{height:600px}
  </style>

<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="materialize.js"></script>
  <script src="init.js"></script>
    
</body>

</html>
